{
  "environment": {
    "mode": "streaming",
    "resultType": "java",
    "parallelism": 1,
    "name": "first"
  },
  "process": {
    "operators": [
      {
        "activated": true,
        "id": "addSource_1",
        "code": "com.zdpx.coder.operator.mysql.MysqlSourceOperator",
        "parallelism": 1,
        "compatibility": 1.0,
        "expanded": true,
        "name": "add environment variable",
        "origin": null,
        "height": 100,
        "width": 90,
        "x": 1,
        "y": 2,
        "parameters": [
          {
            "tableName": "DT",
            "connector": "gbuzl",
            "columns": [
              {
                "name": "t",
                "type": "STRING"
              },
              {
                "name": "data",
                "type": "STRING"
              }
            ]
          }
        ],
        "processes": [
          {
            "expanded": true,
            "operators": [
            ],
            "connects": [
            ]
          }
        ]
      },
      {
        "activated": true,
        "id": "addSource_2",
        "code": "com.zdpx.coder.operator.mysql.MysqlSourceOperator",
        "parallelism": 1,
        "compatibility": 1.0,
        "expanded": true,
        "name": "add environment variable",
        "origin": null,
        "height": 100,
        "width": 90,
        "x": 1,
        "y": 2,
        "parameters": [
          {
            "tableName": "TS",
            "connector": "task",
            "columns": [
              {
                "name": "t",
                "type": "STRING"
              },
              {
                "name": "data",
                "type": "STRING"
              }
            ]
          }
        ],
        "processes": [
          {
            "expanded": true,
            "operators": [
              {
                "activated": true,
                "id": "duplicateOperator_3",
                "code": "com.zdpx.coder.operator.DuplicateOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "DuplicateOperator_3",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "outputName": "output_0"
                  },
                  {
                    "outputName": "output_1"
                  }
                ]
              },
              {
                "activated": true,
                "id": "broadcastOperator",
                "code": "com.zdpx.coder.operator.BroadcastOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "BroadcastOperator_1",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "primary": {
                      "columns": [
                        {
                          "name": "t",
                          "type": "STRING"
                        },
                        {
                          "name": "data",
                          "type": "STRING"
                        }
                      ]
                    },
                    "broadcast": {
                      "columns": [
                        {
                          "name": "data",
                          "type": "STRING"
                        }
                      ]
                    },
                    "output": {
                      "columns": [
                        {
                          "name": "t",
                          "type": "STRING"
                        },
                        {
                          "name": "data",
                          "type": "STRING"
                        },
                        {
                          "name": "task",
                          "type": "STRING"
                        }
                      ]
                    }
                  }
                ]
              },
              {
                "activated": true,
                "id": "commSelectFunctionOperator_gbu",
                "code": "com.zdpx.coder.operator.CommSelectFunctionOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "commSelectFunctionOperator_gbu",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "fieldFunctions": [
                      {
                        "outName": "type"
                      },
                      {
                        "outName": "id",
                        "functionName": "JSON_VALUE",
                        "parameters": [
                          "data",
                          "'$.id'"
                        ]
                      },
                      {
                        "outName": "longitude",
                        "functionName": "JSON_VALUE",
                        "parameters": [
                          "data",
                          "'$.longitude'"
                        ]
                      },
                      {
                        "outName": "latitude",
                        "functionName": "JSON_VALUE",
                        "parameters": [
                          "data",
                          "'$.latitude'"
                        ]
                      },
                      {
                        "outName": "dt",
                        "functionName": "JSON_VALUE",
                        "parameters": [
                          "data",
                          "'$.dt[1]'"
                        ]
                      },
                      {
                        "outName": "v",
                        "functionName": "JSON_VALUE",
                        "parameters": [
                          "data",
                          "'$.value'"
                        ]
                      },
                      {
                        "outName": "taskId"
                      },
                      {
                        "outName": "taskStatus"
                      }
                    ],
                    "where": "type='gbu'"
                  }
                ]
              },
              {
                "activated": true,
                "id": "commSelectFunctionOperator_add",
                "code": "com.zdpx.coder.operator.CommSelectFunctionOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "commSelectFunctionOperator_add",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "fieldFunctions": [
                      {
                        "outName": "longitude",
                        "functionName": "ntimes",
                        "parameters": [
                          "longitude",
                          1000
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "activated": true,
                "id": "commSelectFunctionOperator",
                "code": "com.zdpx.coder.operator.CommSelectFunctionOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "commSelectFunctionOperator",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "fieldFunctions": [
                      {
                        "outName": "type",
                        "functionName": "CAST",
                        "delimiter": "AS",
                        "parameters": [
                          "t",
                          "STRING"
                        ]
                      },
                      {
                        "outName": "data"
                      },
                      {
                        "outName": "taskId",
                        "functionName": "JSON_VALUE",
                        "parameters": [
                          "task",
                          "'$.taskId'"
                        ]
                      },
                      {
                        "outName": "taskStatus",
                        "functionName": "CAST",
                        "delimiter": "AS",
                        "parameters": [
                          {
                            "functionName": "JSON_VALUE",
                            "parameters": [
                              "task",
                              "'$.taskStatus'"
                            ]
                          },
                          "INT"
                        ]
                      },
                      {
                        "outName": "proc_time",
                        "parameters": [
                          "PROCTIME()"
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "activated": true,
                "id": "cepOperator",
                "code": "com.zdpx.coder.operator.CepOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "CepOperator",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "partition": "taskId",
                    "orderBy": "proc_time",
                    "patterns": [
                      {
                        "variable": "A",
                        "quantifier": "{5}"
                      }
                    ],
                    "skipStrategy": {
                      "strategy": "LAST_ROW",
                      "variable": "A"
                    },
                    "measures": [
                      {
                        "outName": "startTaskStatus",
                        "functionName": "FIRST",
                        "parameters": [
                          "A.taskStatus"
                        ]
                      },
                      {
                        "outName": "endTaskStatus",
                        "functionName": "LAST",
                        "parameters": [
                          "A.taskStatus"
                        ]
                      }
                    ],
                    "defines": [
                      {
                        "variable": "A",
                        "condition": "A.taskStatus = 0"
                      }
                    ]
                  }
                ]
              },
              {
                "activated": true,
                "id": "mysqlSink_1",
                "code": "com.zdpx.coder.operator.mysql.MysqlSinkOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "MysqlSinkOperator_1",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "tableName": "ts",
                    "connector": "jdbc",
                    "url": "jdbc:mysql://192.168.17.132:3306/flink?allowPublicKeyRetrieval=true",
                    "username": "root",
                    "password": "123456",
                    "columns": [
                      {
                        "name": "type",
                        "type": "STRING"
                      },
                      {
                        "name": "id",
                        "type": "STRING"
                      },
                      {
                        "name": "longitude",
                        "type": "STRING"
                      },
                      {
                        "name": "latitude",
                        "type": "STRING"
                      },
                      {
                        "name": "dt",
                        "type": "STRING"
                      },
                      {
                        "name": "v",
                        "type": "STRING"
                      },
                      {
                        "name": "taskId",
                        "type": "STRING"
                      },
                      {
                        "name": "taskStatus",
                        "type": "INT"
                      }
                    ]
                  }
                ]
              },
              {
                "activated": true,
                "id": "mysqlSink_2",
                "code": "com.zdpx.coder.operator.mysql.MysqlSinkOperator",
                "parallelism": 1,
                "compatibility": 1.0,
                "expanded": true,
                "name": "MysqlSinkOperator_2",
                "origin": null,
                "height": 150,
                "width": 90,
                "x": 1,
                "y": 2,
                "parameters": [
                  {
                    "tableName": "match",
                    "connector": "jdbc",
                    "url": "jdbc:mysql://192.168.17.132:3306/flink?allowPublicKeyRetrieval=true",
                    "username": "root",
                    "password": "123456",
                    "columns": [
                      {
                        "name": "taskId",
                        "type": "STRING"
                      },
                      {
                        "name": "startTaskStatus",
                        "type": "INT"
                      },
                      {
                        "name": "endTaskStatus",
                        "type": "INT"
                      }
                    ]
                  }
                ]
              }
            ],
            "connects": [
              {
                "fromOp": "addSource_1",
                "toOp": "broadcastOperator",
                "fromPort": "output_0",
                "toPort": "primaryInput"
              },
              {
                "fromOp": "addSource_2",
                "toOp": "broadcastOperator",
                "fromPort": "output_0",
                "toPort": "broadcastInput"
              },
              {
                "fromOp": "broadcastOperator",
                "toOp": "commSelectFunctionOperator",
                "fromPort": "output_0",
                "toPort": "input_0"
              },
              {
                "fromOp": "commSelectFunctionOperator",
                "toOp": "duplicateOperator_3",
                "fromPort": "output_0",
                "toPort": "input_0"
              },
              {
                "fromOp": "duplicateOperator_3",
                "toOp": "commSelectFunctionOperator_gbu",
                "fromPort": "output_1",
                "toPort": "input_0"
              },
              {
                "fromOp": "duplicateOperator_3",
                "toOp": "cepOperator",
                "fromPort": "output_0",
                "toPort": "input_0"
              },
              {
                "fromOp": "commSelectFunctionOperator_gbu",
                "toOp": "commSelectFunctionOperator_add",
                "fromPort": "output_0",
                "toPort": "input_0"
              },
              {
                "fromOp": "commSelectFunctionOperator_add",
                "toOp": "mysqlSink_1",
                "fromPort": "output_0",
                "toPort": "input_0"
              },
              {
                "fromOp": "cepOperator",
                "toOp": "mysqlSink_2",
                "fromPort": "output_0",
                "toPort": "input_0"
              }
            ]
          }
        ]
      }
    ],
    "connects": [
    ],
    "descriptions": [
      {
        "align": "Center",
        "color": "Red",
        "height": 264,
        "width": 50,
        "resized": false,
        "x": 403,
        "y": 188,
        "context": "nothing"
      }
    ]
  }
}
